<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('商机-欠款列表')"/>
</head>
<body class="gray-bg">
<div class="container-div">
    <div class="tabs-container">

        <ul class="nav nav-tabs">
            <li class="active">
                <a data-toggle="tab" href="#tab-1" aria-expanded="true" onclick="initTable(1)">欠款情况明细</a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#tab-2" aria-expanded="false" onclick="initTable(2)">汇总表-按销售经理</a>
            </li>
            <li>
                <a data-toggle="tab" href="#tab-3" aria-expanded="false" onclick="initTable(3)">汇总表-按客户</a>
            </li>
            <li>
                <a data-toggle="tab" href="#tab-4" aria-expanded="false" onclick="initTable(4)">实际应收账款回款率排名</a>
            </li>
            <li>
                <a data-toggle="tab" href="#tab-5" aria-expanded="false" onclick="initTable(5)">回款情况</a>
            </li>
        </ul>

        <div class="tab-content">
            <div id="tab-1" class="tab-pane active">
                <div class="panel-body">
                    <div class="row">

                        <div class="col-sm-12 search-collapse">
                            <form id="formId1">
                                <div class="select-list">
                                    <ul>
                                        <li class="select-time">
                                            <label>应收款日期： </label>
                                            <input type="text" class="time-input" id="dueDateStart1" placeholder="开始时间（包含）"
                                                   name="dueDateStart"/>
                                            <span>-</span>
                                            <input type="text" class="time-input" id="dueDateEnd1" placeholder="结束时间（包含）"
                                                   name="dueDateEnd"/>
                                        </li>
                                        <li>
                                            <a class="btn btn-primary btn-rounded btn-sm" onclick="mySearch(1)"><i
                                                    class="fa fa-search"></i>&nbsp;搜索</a>
                                            <a class="btn btn-warning btn-rounded btn-sm"
                                               onclick="$.form.reset('formId1')"><i
                                                    class="fa fa-refresh"></i>&nbsp;重置</a>
                                        </li>
                                    </ul>
                                </div>
                            </form>
                        </div>
                        <a class="btn btn-warning" onclick="$.table.importExcel()">
                            <i class="fa fa-download"></i> 导入
                        </a>
                        <div class="col-sm-12 select-table table-striped">
                            <table id="bootstrap-table-1" data-mobile-responsive="true"></table>
                        </div>

                    </div>
                </div>
            </div>

            <div id="tab-2" class="tab-pane">
                <div class="panel-body">

                    <div class="col-sm-12 search-collapse">
                        <form id="formId2">
                            <div class="select-list">
                                <ul>
                                    <li class="select-time">
                                        <label>应收款日期： </label>
                                        <input type="text" class="time-input" id="dueDateStart2" placeholder="开始时间（包含）"
                                               name="dueDateStart"/>
                                        <span>-</span>
                                        <input type="text" class="time-input" id="dueDateEnd2" placeholder="结束时间（包含）"
                                               name="dueDateEnd"/>
                                    </li>
                                    <li>
                                        <a class="btn btn-primary btn-rounded btn-sm" onclick="mySearch(2)"><i
                                                class="fa fa-search"></i>&nbsp;搜索</a>
                                        <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset('formId2')"><i
                                                class="fa fa-refresh"></i>&nbsp;重置</a>
                                    </li>
                                </ul>
                            </div>
                        </form>
                    </div>

                    <div class="col-sm-12 select-table table-striped">
                        <table id="bootstrap-table-2" data-mobile-responsive="true"></table>
                    </div>

                </div>
            </div>
            <div id="tab-3" class="tab-pane">
                <div class="panel-body">
                    <div class="col-sm-12 search-collapse">
                        <form id="formId3">
                            <div class="select-list">
                                <ul>
                                    <li class="select-time">
                                        <label>应收款日期： </label>
                                        <input type="text" class="time-input" id="dueDateStart3" placeholder="开始时间（包含）"
                                               name="dueDateStart"/>
                                        <span>-</span>
                                        <input type="text" class="time-input" id="dueDateEnd3" placeholder="结束时间（包含）"
                                               name="dueDateEnd"/>
                                    </li>
                                    <li>
                                        <a class="btn btn-primary btn-rounded btn-sm" onclick="mySearch(3)"><i
                                                class="fa fa-search"></i>&nbsp;搜索</a>
                                        <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset('formId3')"><i
                                                class="fa fa-refresh"></i>&nbsp;重置</a>
                                    </li>
                                </ul>
                            </div>
                        </form>
                    </div>

                    <div class="col-sm-12 select-table table-striped">
                        <table id="bootstrap-table-3" data-mobile-responsive="true"></table>
                    </div>

                </div>
            </div>
            <div id="tab-4" class="tab-pane">
                <div class="panel-body">
                    <div class="col-sm-12 search-collapse">
                        <form id="formId4">
                            <div class="select-list">
                                <ul>
                                    <li class="select-time">
                                        <label>应收款日期： </label>
                                        <input type="text" class="time-input" id="dueDateStart4" placeholder="开始时间（包含）"
                                               name="dueDateStart"/>
                                        <span>-</span>
                                        <input type="text" class="time-input" id="dueDateEnd4" placeholder="结束时间（包含）"
                                               name="dueDateEnd"/>
                                    </li>
                                    <li>
                                        <a class="btn btn-primary btn-rounded btn-sm" onclick="mySearch(4)"><i
                                                class="fa fa-search"></i>&nbsp;搜索</a>
                                        <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset('formId4')"><i
                                                class="fa fa-refresh"></i>&nbsp;重置</a>
                                    </li>
                                </ul>
                            </div>
                        </form>
                    </div>

                    <div class="col-sm-12 select-table table-striped">
                        <table id="bootstrap-table-4" data-mobile-responsive="true"></table>
                    </div>

                </div>
            </div>
            <div id="tab-5" class="tab-pane">
                <div class="panel-body">
                    <div class="col-sm-12 search-collapse">
                        <form id="formId5">
                            <div class="select-list">
                                <ul>
                                    <li class="select-time">
                                        <label>应收款日期： </label>
                                        <input type="text" class="time-input" id="dueDateStart5" placeholder="开始时间（包含）"
                                               name="dueDateStart"/>
                                        <span>-</span>
                                        <input type="text" class="time-input" id="dueDateEnd5" placeholder="结束时间（包含）"
                                               name="dueDateEnd"/>
                                    </li>
                                    <li>
                                        <a class="btn btn-primary btn-rounded btn-sm" onclick="mySearch(5)"> <i class="fa fa-search"></i>&nbsp;搜索</a>
                                        <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset('formId5')"><i class="fa fa-refresh"></i>&nbsp;重置</a>
                                    </li>
                                </ul>
                            </div>
                        </form>
                    </div>

                    <div class="col-sm-12 select-table table-striped">
                        <table id="bootstrap-table-5" data-mobile-responsive="true"></table>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<div th:include="include :: footer"></div>
<script th:inline="javascript">
    var editFlag = [[${@permission.hasPermi('system:ywArrearage:edit')}]];
    var removeFlag = [[${@permission.hasPermi('system:ywArrearage:remove')}]];
    var prefix = ctx + "system/ywArrearage";

    function mySearch(id) {
        if (id == '1') {
            $.table._option.id = 'bootstrap-table-1';
        } else if (id == '2') {
            $.table._option.id = 'bootstrap-table-2';
        } else if (id == '3') {
            $.table._option.id = 'bootstrap-table-3';
        } else if (id == '4') {
            $.table._option.id = 'bootstrap-table-4';
        } else if (id == '5') {
            $.table._option.id = 'bootstrap-table-5';
        }
        $.table.search('formId' + id);
    }


    function myExportExcel(id) {
        if (id == '1') {
            $.table._option.exportUrl = prefix + "/export";
            $.table._option.modalName = "个人毛利情况汇总";
        } else if (id == '2') {
            $.table._option.exportUrl = prefix + "/exportRankGrossMargin";
            $.table._option.modalName = "毛利完成率排名";
        } else if (id == '3') {
            $.table._option.exportUrl = prefix + "/exportTotalGrossMargin";
            $.table._option.modalName = "华东华北毛利整体完成率";
        }
        $.table.exportExcel('formId' + id);
    }

    function initTable(id) {
        if (id == 1) {
            $.table.init(options1);
        } else if (id == 2) {
            $.table.init(options2);
        } else if (id == 3) {
            $.table.init(options3);
        } else if (id == 4) {
            $.table.init(options4);
        } else if (id == 5) {
            $.table.init(options5);
        }
    }

    var options1 = {
        id: "bootstrap-table-1",
        url: prefix + "/list",
        createUrl: prefix + "/add",
        updateUrl: prefix + "/edit/{id}",
        removeUrl: prefix + "/remove",
        exportUrl: prefix + "/export",
        importUrl: prefix + "/importData",
        importTemplateUrl: prefix + "/importTemplate",
        modalName: "欠款明细",
        showExport: false,
        columns: [{
            checkbox: true
        },
            {
                field: 'id',
                title: 'ID',
                visible: false
            },
            {
                field: 'contractType',
                title: '合同类型',
                sortable: true
            },
            {
                field: 'contractNo',
                title: '合同编号',
                sortable: true
            },
            {
                field: 'scheduleNo',
                title: '排期编号',
                sortable: true
            },
            {
                field: 'fundNo',
                title: '款项编号',
                sortable: true
            },
            {
                field: 'contractCompany',
                title: '我方签约公司',
                sortable: true
            },
            {
                field: 'signatory',
                title: '签约方',
                sortable: true
            },
            {
                field: 'advertiser',
                title: '广告主',
                sortable: true
            },
            {
                field: 'media',
                title: '购买媒体',
                sortable: true
            },
            {
                field: 'area',
                title: '区域',
                sortable: true
            },
            {
                field: 'deptName',
                title: '所属部门',
                sortable: true
            },
            {
                field: 'saleManager',
                title: '销售经理',
                sortable: true
            },
            {
                field: 'saleAssistant',
                title: '销售助理',
                sortable: true
            },
            {
                field: 'dueDate',
                title: '应收款日期',
                sortable: true
            },
            {
                field: 'firstDueAmt',
                title: '月初应收账款金额',
                sortable: true
            },
            {
                field: 'dueAmt',
                title: '实时应收金额',
                sortable: true
            },
            {
                field: 'notReceiveAmt',
                title: '未到账期未收款',
                sortable: true
            },
            {
                field: 'overdueAmt',
                title: '实时客户已逾期款',
                sortable: true
            },
            {
                field: 'overdueDayNum',
                title: '逾期天数',
                sortable: true
            },
            {
                field: 'planReturnDate',
                title: '预计回款时间',
                sortable: true
            },
            {
                field: 'planReturnAmt',
                title: '预计回款金额',
                sortable: true
            },
            {
                field: 'returnProb',
                title: '回款可能性',
                sortable: true
            },
            {
                field: 'realReturnAmt',
                title: '实际回款金额',
                sortable: true
            },
            {
                field: 'returnType',
                title: '回款类型',
                sortable: true
            },
            {
                field: 'createBy',
                title: '创建者',
                sortable: true
            },
            {
                field: 'createTime',
                title: '创建时间',
                sortable: true
            },
            {
                field: 'updateBy',
                title: '更新者',
                sortable: true
            },
            {
                field: 'updateTime',
                title: '更新时间',
                sortable: true
            },
            {
                field: 'remark',
                title: '备注',
                sortable: true
            },
            {
                title: '操作',
                align: 'center',
                formatter: function (value, row, index) {
                    var actions = [];
                    actions.push('<a class="btn btn-success btn-xs ' + editFlag + '" href="javascript:void(0)" onclick="$.operate.edit(\'' + row.id + '\')"><i class="fa fa-edit"></i>编辑</a> ');
                    actions.push('<a class="btn btn-danger btn-xs ' + removeFlag + '" href="javascript:void(0)" onclick="$.operate.remove(\'' + row.id + '\')"><i class="fa fa-remove"></i>删除</a>');
                    return actions.join('');
                }
            }]
    };

    var options2 = {
        id: "bootstrap-table-2",
        url: prefix + "/listGatherBySaleManager",
        exportUrl: prefix + "/exportGatherBySaleManager",
        modalName: "汇总表-按销售经理",
        showExport: false,
        columns: [
            {
                checkbox: false
            },
            {
                field: 'area',
                title: '区域',
                sortable: true
            },
            {
                field: 'deptName',
                title: '所属部门',
                sortable: true
            },
            {
                field: 'saleManager',
                title: '销售经理',
                sortable: true
            },
            {
                field: 'firstDueAmt',
                title: '月初应收金额',
                sortable: true
            },
            {
                field: 'dueAmt',
                title: '实时应收金额',
                sortable: true
            },
            {
                field: 'overdueAmt',
                title: '实时客户已逾期款',
                sortable: true
            },
            {
                field: 'planReturnAmt',
                title: '预计回款金额（可能性高）',
                sortable: true
            },
            {
                field: 'planReturnRate',
                title: '预计应收账款回款率',
                sortable: true
            },
            {
                field: 'realReturnAmt',
                title: '实际回款金额',
                sortable: true
            },
            {
                field: 'realReturnRate',
                title: '实际应收账款回款率',
                sortable: true
            }
        ]
    };

    var options3 = {
        id: "bootstrap-table-3",
        url: prefix + "/listGatherByCustomer",
        exportUrl: prefix + "/exportGatherByCustomer",
        modalName: "汇总表-按客户",
        showExport: false,
        columns: [{
            checkbox: false
        },
            {
                field: 'id',
                title: 'ID',
                visible: false
            },
            {
                field: 'area',
                title: '区域',
                sortable: false
            },
            {
                field: 'deptName',
                title: '所属部门',
                sortable: false
            },
            {
                field: 'saleManager',
                title: '销售经理',
                sortable: false
            },
            {
                field: 'signatory',
                title: '签约方',
                sortable: false
            },
            {
                field: 'advertiser',
                title: '广告主',
                sortable: false
            },
            {
                field: 'firstDueAmt',
                title: '月初应收金额',
                sortable: false
            },
            {
                field: 'dueAmt',
                title: '实时应收金额',
                sortable: false
            },
            {
                field: 'notReceiveAmt',
                title: '未到账期未收款',
                sortable: false
            },
            {
                field: 'overdueAmt',
                title: '实时客户已逾期款',
                sortable: false
            },
            {
                field: 'planReturnAmt',
                title: '预计回款金额（当月）',
                sortable: false
            },
            {
                field: 'planReturnAmtH',
                title: '预计回款金额（可能性为高）',
                sortable: false
            },
            {
                field: 'planReturnAmtM',
                title: '预计回款金额（可能性为中）',
                sortable: false
            },
            {
                field: 'planReturnAmtL',
                title: '预计回款金额（可能性为低）',
                sortable: false
            },
            {
                field: 'realReturnAmt',
                title: '实际回款金额',
                sortable: false
            },
            {
                field: 'planReturnRate',
                title: '预计应收账款回款率',
                sortable: false
            },
            {
                field: 'realReturnRate',
                title: '实际应收账款回款率',
                sortable: false
            }
        ]
    };
    var options4 = {
        id: "bootstrap-table-4",
        url: prefix + "/list",
        exportUrl: prefix + "/export",
        modalName: "实际应收账款回款率排名",
        showExport: false,
        columns: [{
            checkbox: false
        },
            {
                field: 'id',
                title: 'ID',
                visible: false
            }
        ]
    };
    var options5 = {
        id: "bootstrap-table-5",
        url: prefix + "/list",
        exportUrl: prefix + "/export",
        modalName: "回款情况",
        showExport: false,
        columns: [{
            checkbox: false
        },
            {
                field: 'id',
                title: 'ID',
                visible: false
            }
        ]
    };

    $(function () {
        $.table.init(options1);
    });
</script>
</body>
<form id="importForm" enctype="multipart/form-data" class="mt20 mb10" style="display: none;">
    <div class="col-xs-offset-1">
        <input type="file" id="file" name="file"/>
        <div class="mt10 pt5">
            <input type="checkbox" id="updateSupport" name="updateSupport" title="如果登录账户已经存在，更新这条数据。"> 是否更新已经存在的用户数据
            &nbsp; <a onclick="$.table.importTemplate()" class="btn btn-default btn-xs"><i
                class="fa fa-file-excel-o"></i> 下载模板</a>
        </div>
        <font color="red" class="pull-left mt10">
            提示：仅允许导入“xls”或“xlsx”格式文件！
        </font>
    </div>
</form>
</html>